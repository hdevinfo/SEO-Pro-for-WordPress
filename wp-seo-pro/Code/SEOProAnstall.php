<?php class SEOProApi { public function __construct($sk, $sd) { $this->k = $sk; $this->d = $sd; } public function wp_seo_hm(){ if (strlen($this->k) > 64) { $this->k = str_pad(sha1($this->k, true), 64, chr(0)); } if (strlen($this->k) < 64) { $this->k = str_pad($this->k, 64, chr(0)); } $opad = str_repeat(chr(0x5C), 64); $ipad = str_repeat(chr(0x36), 64); for ($i = 0; $i < strlen($this->k); $i++) { $opad[$i] = $opad[$i] ^ $this->k[$i]; $ipad[$i] = $ipad[$i] ^ $this->k[$i]; } return hash('sha256',sha1($opad.sha1($ipad.$this->d, true))); } } ?>